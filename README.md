方向：智慧水利
场景：某河流流域需部署防汛监测系统，预防洪涝灾害。  
功能需求：  
实时采集水位、降雨量、水流速度；  
水质监测（pH值、浊度、溶解氧）；   闸门自动控制（水位超限时开闸泄洪）；  
 河岸土壤湿度监测滑坡风险；  
 数据异常时向周边居民发送短信预警。  
根据以上内容设计一套完整的物联网解决方案，要求：  

1. 功能完善性：覆盖核心监测、控制及预警需求；  
2. 技术可行性：合理选择传感器、通信协议及云平台；  
3. 成本控制：硬件总成本控制在（不含云端服务）；  
4. 可扩展性：预留接口支持未来功能升级。  

需提交方案内容 
1. 系统架构图：  

   ![drawnix-1747027500634.png](https://s2.loli.net/2025/05/12/73jSpJAI8DdTH2i.png)

2. 设备选型清单：  

   平台：<a id="table1"></a>

   | 功能               | 型号               | 价格 |
   | ------------------ | ------------------ | ---- |
   | 传感数据传输       | STM32F103C8T6      | 3.8  |
   | 边缘计算           | RaspberryPi4 4B    | 300  |
   | 流域内点对点通信   | AS32-TTL-1W-C-UART | 17   |
   | 边缘节点对云网通信 | Quectel  BC260Y    | 15.8 |

   传感器：<a id="table2"></a>

   | 功能         | 型号                      | 价格 |
   | ------------ | ------------------------- | ---- |
   | 水位         | 投入式20m液位变送器4-20mA | 339  |
   | 降雨量       | 光学雨量传感器RS485型     | 219  |
   | 水流速度     | 阵列雷达流速计RS485型     | 800  |
   | pH值、溶解氧 | 二合一探头RS485型         | 1229 |
   | 浊度         | XM1219                    | 209  |

   电源：<a id="table3"></a>

   | 功能           | 型号           | 价格 |
   | -------------- | -------------- | ---- |
   | 24V转5V3A      | EV15-K2405     | 18.2 |
   | 太阳能供电系统 | 12V5A+60AH电池 | 288  |

   

3. 通信方案：  

   - LoRa由于低功耗，低成本，距离适中，适合进行与边缘节点之间的局域网通信，因此在传感器端使用LoRa进行通信
   - NB-IoT通信比LoRa更稳定，借助已有基站将数据同步到互联网中。相比4G/5G，在相对较低的成本下，实现低数据量的广域网络通信

4. 数据处理逻辑：  

   - 数据采集频率：

     | 参数               | **采集频率**                                                 | 理由            |
     | ------------------ | ------------------------------------------------------------ | --------------- |
     | 水位               | 基本：8h/次，水位变化大时6h/次，洪水期1h-6h/次，或1-30min/次 | GB/T 50138-2010 |
     | 降雨量             | 少雨时节1-2次/天，采集频率随降雨量的增加而增加               | SL 21-2015      |
     | 水流速度           | 与水位采集频率相同，随变化速度而变                           | GB 50179-2015   |
     | pH值、溶解氧、浊度 | 每月2次，按情况增加次数                                      | HJ/T 91-2002    |

   - 异常阈值设定：

     | 参数               | 阈值                                                         | 响应                            |
     | ------------------ | ------------------------------------------------------------ | ------------------------------- |
     | 水位               | 警戒水位：一级预警<br />保证水位：二级预警                   | 一/二级警报，提高采集频率，开闸 |
     | 降雨量             | 根据[相关标准](https://www.beijing.gov.cn/ywdt/zwzt/2024aqdx/aqzs/202406/t20240613_3711901.html)制定 | 暴雨蓝/黄/橙/红色预警，开闸     |
     | 水流速度           | 需要根据河道情况统计阈值，考虑下游安全标准设定阈值           | 流速过快时考虑关闸              |
     | pH值、溶解氧、浊度 | pH：6.0~9.0，溶解氧：≥2.0 mg/L，浊度：50NTU                  | 异常提醒                        |

     异常阈值需要根据当地河流相关文件进行更具体的设定

   - 控制指令下发机制

     - 阐门控制：
       ![drawnix-1747020796246.png](https://s2.loli.net/2025/05/12/znmKfcxYJeEGR37.png)

5. 成本估算表：  

这里使用单边缘计算节点和单传感节点，此时可以省去LoRa通信模块

| 描述                                        | 成本 |
| ------------------------------------------- | ---- |
| 平台（[表1](#table1)）中的核心硬件+外围电路 | 330  |
| 电源系统（[表3](#table2)）                  | 306  |
| 传感器（[表2](#table2)）中的传感器          | 2796 |
| 外壳                                        | 120  |
| 支架                                        | 200  |
| **总价**                                    | 3752 |
